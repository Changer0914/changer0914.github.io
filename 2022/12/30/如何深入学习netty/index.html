<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>如何深入学习netty | focus and smile</title>
  <meta name="keywords" content=" netty ">
  <meta name="description" content="如何深入学习netty | focus and smile">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="2022年总结在数云做的工作比较杂，亮点少，不向juan那样，说起ta就能想到网关、聚石塔日志、sla监控，这些对他涨薪、评级等非常有帮助，惭愧的是我却没有。 目前负责的工作项有： 用户中心 应用中心 渠道优化 有赞权益 订购中心 配置中心 cmdb、 开放平台&#x2F;回调平台 权限开通  这些仅有赞权益是自己从头到尾完成的，其他都是维护工作或者不是主负责人。如果更用心的话，每一项都能取得成就，“没有最">
<meta property="og:type" content="article">
<meta property="og:title" content="2022年工作总结与23年展望">
<meta property="og:url" content="http://www.dotoday.cn/2023/01/11/2022%E5%B9%B4%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93%E4%B8%8E23%E5%B9%B4%E5%B1%95%E6%9C%9B/index.html">
<meta property="og:site_name" content="focus and smile">
<meta property="og:description" content="2022年总结在数云做的工作比较杂，亮点少，不向juan那样，说起ta就能想到网关、聚石塔日志、sla监控，这些对他涨薪、评级等非常有帮助，惭愧的是我却没有。 目前负责的工作项有： 用户中心 应用中心 渠道优化 有赞权益 订购中心 配置中心 cmdb、 开放平台&#x2F;回调平台 权限开通  这些仅有赞权益是自己从头到尾完成的，其他都是维护工作或者不是主负责人。如果更用心的话，每一项都能取得成就，“没有最">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2023-01-11T02:38:31.000Z">
<meta property="article:modified_time" content="2023-01-11T02:46:50.170Z">
<meta property="article:author" content="净霆">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/atom-light.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 5.4.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/avatar.jpg"/>
</a>
<div class="author">
    <span>净霆</span>
</div>

<div class="icon">
    
        
            <a title="github"
               href="https://gitee.com/smartshuai"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="email"
               href="mailto:jingting969@gmail.com"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-email"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="qq"
               href="http://wpa.qq.com/msgrd?v=3&uin=1228227587&site=qq&menu=yes"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-qq"></use>
                    </svg>
                
            </a>
        
    
</div>




<ul>
    <li>
        <div class="all active" data-rel="All">All
            
                <small>(15)</small>
            
        </div>
    </li>
    
        
            
                <li>
                    <div data-rel="软文">
                        
                        软文
                        <small>(4)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="netty">
                        
                        netty
                        <small>(2)</small>
                        
                    </div>
                    
                </li>
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
    </div>
    <div>
        
        <a 
                                           class="friends">Friends</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="15">

<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        Links
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="https://snailclimb.gitee.io/javaguide/#/">面向面试学习</a></li>
            
            <li><a target="_blank" href="https://www.iocoder.cn">学习源码</a></li>
            
            <li><a target="_blank" href="https://time.geekbang.org/dashboard/course">极客课程</a></li>
            
            <li><a target="_blank" href="https://pixabay.com/zh/">图片素材库</a></li>
            
            <li><a target="_blank" href="https://www.thoughtworks.com/cn/radar">技术雷达</a></li>
            
            <li><a target="_blank" href="https://archsummit.infoq.cn/">全球架构师峰会</a></li>
            
            <li><a target="_blank" href="https://mp.weixin.qq.com/s/mNsvbBPREn5CtPb_waWbjA">加入dromara社区</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="搜索 快捷键 i"></i>
            <div class="right-title">All</div>
            <i class="iconfont icon-file-tree" data-title="切换到大纲视图 快捷键 w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="返回"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="大小写敏感"></i>
            <i class="iconfont icon-tag" data-title="标签"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">大纲</div>
            <i class="iconfont icon-list" data-title="切换到文章列表"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>并发编程</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>技术</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>剑指offer</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>框架基础</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>软文</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>运维</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>杂记</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>知识网</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>docker</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>netty</a>
            </li>
        
    </div>

</div>

    
    <nav id="title-list-nav">
        
        
        <a  class="All "
           href="/2023/01/11/2022%E5%B9%B4%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93%E4%B8%8E23%E5%B9%B4%E5%B1%95%E6%9C%9B/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="2022年工作总结与23年展望">2022年工作总结与23年展望</span>
            <span class="post-date" title="2023-01-11 10:38:31">2023/01/11</span>
        </a>
        
        
        <a  class="All netty "
           href="/2022/12/30/%E5%A6%82%E4%BD%95%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0netty/"
           data-tag="netty"
           data-author="" >
            <span class="post-title" title="如何深入学习netty">如何深入学习netty</span>
            <span class="post-date" title="2022-12-30 15:53:01">2022/12/30</span>
        </a>
        
        
        <a  class="All 软文 "
           href="/2022/12/30/%E6%8E%A2%E7%B4%A2%E5%8F%91%E7%8E%B0%EF%BC%9A%E6%88%91%E6%83%B3%E5%B9%B2%E4%BB%80%E4%B9%88/"
           data-tag="软文"
           data-author="" >
            <span class="post-title" title="探索发现：我想干什么">探索发现：我想干什么</span>
            <span class="post-date" title="2022-12-30 11:10:12">2022/12/30</span>
        </a>
        
        
        <a  class="All netty "
           href="/2022/12/30/%E6%94%BB%E5%85%8Bnetty%EF%BC%9Atio%E5%92%8Cnetty%E5%AD%A6%E5%93%AA%E4%B8%AA/"
           data-tag="netty"
           data-author="" >
            <span class="post-title" title="攻克netty：tio和netty学哪个">攻克netty：tio和netty学哪个</span>
            <span class="post-date" title="2022-12-30 11:08:13">2022/12/30</span>
        </a>
        
        
        <a  class="All "
           href="/2022/10/25/%E5%89%91%E6%8C%87offer%EF%BC%9A01-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"
           data-tag="剑指offer"
           data-author="" >
            <span class="post-title" title="剑指offer：01. 数据结构基础知识">剑指offer：01. 数据结构基础知识</span>
            <span class="post-date" title="2022-10-25 14:44:33">2022/10/25</span>
        </a>
        
        
        <a  class="All "
           href="/2022/10/19/docker%E5%88%B6%E4%BD%9C%E9%95%9C%E5%83%8F%E5%8F%8A%E6%8E%A8%E9%80%81/"
           data-tag="docker,运维"
           data-author="" >
            <span class="post-title" title="docker制作镜像及推送">docker制作镜像及推送</span>
            <span class="post-date" title="2022-10-19 09:46:23">2022/10/19</span>
        </a>
        
        
        <a  class="All "
           href="/2022/10/18/%E4%B8%93%E6%B3%A8%E5%87%BA%E5%89%91%E6%8C%87offer%E7%B3%BB%E5%88%97%E6%96%87/"
           data-tag="剑指offer"
           data-author="" >
            <span class="post-title" title="专注剑指offer：总">专注剑指offer：总</span>
            <span class="post-date" title="2022-10-18 11:17:02">2022/10/18</span>
        </a>
        
        
        <a  class="All 软文 "
           href="/2021/11/19/%E6%8A%80%E6%9C%AF%E4%BA%BA%E7%9A%84%E6%80%9D%E8%80%83%E6%A1%86%E6%9E%B6/"
           data-tag="软文"
           data-author="" >
            <span class="post-title" title="技术人的思考框架">技术人的思考框架</span>
            <span class="post-date" title="2021-11-19 14:17:15">2021/11/19</span>
        </a>
        
        
        <a  class="All "
           href="/2021/09/30/%E6%A1%86%E6%9E%B6%E5%9F%BA%E7%A1%80%EF%BC%9Ajvm/"
           data-tag="技术,框架基础"
           data-author="" >
            <span class="post-title" title="框架基础：jvm垃圾回收">框架基础：jvm垃圾回收</span>
            <span class="post-date" title="2021-09-30 16:02:52">2021/09/30</span>
        </a>
        
        
        <a  class="All "
           href="/2021/09/10/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/"
           data-tag="技术,框架基础,并发编程"
           data-author="" >
            <span class="post-title" title="框架基础：并发编程">框架基础：并发编程</span>
            <span class="post-date" title="2021-09-10 12:25:40">2021/09/10</span>
        </a>
        
        
        <a  class="All "
           href="/2021/09/04/%E6%A1%86%E6%9E%B6%E5%9F%BA%E7%A1%80%EF%BC%9A%E7%B1%BB%E5%8A%A0%E8%BD%BD/"
           data-tag="技术,框架基础"
           data-author="" >
            <span class="post-title" title="框架基础：类加载">框架基础：类加载</span>
            <span class="post-date" title="2021-09-04 18:16:49">2021/09/04</span>
        </a>
        
        
        <a  class="All "
           href="/2021/05/02/%E6%9E%84%E5%BB%BAjava%E7%9F%A5%E8%AF%86%E7%BD%91/"
           data-tag="技术,知识网"
           data-author="" >
            <span class="post-title" title="构建java知识网">构建java知识网</span>
            <span class="post-date" title="2021-05-02 09:30:45">2021/05/02</span>
        </a>
        
        
        <a  class="All 软文 "
           href="/2021/04/29/%E5%A6%82%E4%BD%95%E5%BF%AB%E9%80%9F%E5%AD%A6%E4%B9%A0%E4%B8%80%E9%97%A8%E6%96%B0%E6%8A%80%E6%9C%AF/"
           data-tag="软文"
           data-author="" >
            <span class="post-title" title="如何快速学习一门新技术">如何快速学习一门新技术</span>
            <span class="post-date" title="2021-04-29 11:57:07">2021/04/29</span>
        </a>
        
        
        <a  class="All 软文 "
           href="/2021/04/28/%E8%A7%A3%E5%86%B3%E9%97%AE%E9%A2%98%E6%96%B9%E6%B3%95%E8%AE%BA/"
           data-tag="软文"
           data-author="" >
            <span class="post-title" title="解决问题方法论">解决问题方法论</span>
            <span class="post-date" title="2021-04-28 20:29:41">2021/04/28</span>
        </a>
        
        
        <a  class="All "
           href="/2020/10/01/%E6%88%91%E5%86%B3%E5%AE%9A%E9%87%8D%E6%96%B0%E5%86%99%E6%8A%80%E6%9C%AF%E5%8D%9A%E5%AE%A2/"
           data-tag="杂记"
           data-author="" >
            <span class="post-title" title="我决定重新写技术博客">我决定重新写技术博客</span>
            <span class="post-date" title="2020-10-01 10:02:08">2020/10/01</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="切换全屏 快捷键 s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-如何深入学习netty" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">如何深入学习netty</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="netty">netty</a>
            
        </span>
        
        
        <span class="tag">
            <i class="iconfont icon-tag"></i>
            
            <a class="color1">netty</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
            Created At : <time class="date" title='Updated At: 2022-12-30 17:16:24'>2022-12-30 15:53</time>
        
    </div>
    <div class="article-meta">
        
        
        <span id="busuanzi_container_page_pv">
            Views 👀 :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%EF%BC%9A%E9%A2%84%E5%A4%87%E7%9F%A5%E8%AF%86"><span class="toc-text">前：预备知识</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#tcp-ip%E5%8D%8F%E8%AE%AE"><span class="toc-text">tcp&#x2F;ip协议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%B1%82%E6%98%AF%E5%95%A5%EF%BC%9F"><span class="toc-text">应用层是啥？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%B1%82%E6%95%B0%E6%8D%AE%E6%98%AF%E5%95%A5%EF%BC%9F"><span class="toc-text">应用层数据是啥？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%A0%E8%BE%93%E5%B1%82%E6%98%AF%E5%95%A5"><span class="toc-text">传输层是啥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%A0%E8%BE%93%E5%B1%82%E6%95%B0%E6%8D%AE%E6%98%AF%E5%95%A5"><span class="toc-text">传输层数据是啥</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-Netty%E6%9E%B6%E6%9E%84"><span class="toc-text">1 Netty架构</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-text">2 基本概念</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Buffer-ByteBuffer"><span class="toc-text">Buffer: ByteBuffer</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE"><span class="toc-text">3 实战项目</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-IM%E8%81%8A%E5%A4%A9%E7%B1%BB"><span class="toc-text">3.1 IM聊天类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-RPC%E7%B1%BB"><span class="toc-text">3.2 RPC类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SOFABolt"><span class="toc-text">SOFABolt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%A7%E5%8E%A8%E5%B0%8F%E9%B2%9C%E2%80%94%E2%80%94%E5%9F%BA%E4%BA%8ENetty%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%E5%AE%9E%E7%8E%B0RPC%E6%A1%86%E6%9E%B6"><span class="toc-text">大厨小鲜——基于Netty自己动手实现RPC框架</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-MQTT%E7%B1%BB"><span class="toc-text">3.3 MQTT类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-4-Web%E6%A1%86%E6%9E%B6"><span class="toc-text">3.4 Web框架</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-%E7%90%86%E8%A7%A3Netty"><span class="toc-text">4 理解Netty</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%99%E4%B8%80%E4%B8%AA%E5%BA%95%E5%B1%82%E9%80%9A%E4%BF%A1%E6%A1%86%E6%9E%B6%E9%9C%80%E8%A6%81%E8%80%83%E8%99%91%E5%93%AA%E4%BA%9B%EF%BC%9F"><span class="toc-text">写一个底层通信框架需要考虑哪些？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFNetty%EF%BC%9F"><span class="toc-text">什么是Netty？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%98%93%E7%94%A8"><span class="toc-text">易用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%A7%E8%83%BD"><span class="toc-text">性能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E6%80%A7"><span class="toc-text">扩展性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E5%90%8E"><span class="toc-text">最后</span></a></li></ol></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>看了《Netty权威指南》，真实枯燥，完全看不下去，打算这么学习下Netty。</p>
<h1 id="前：预备知识"><a href="#前：预备知识" class="headerlink" title="前：预备知识"></a>前：预备知识</h1><h2 id="tcp-ip协议"><a href="#tcp-ip协议" class="headerlink" title="tcp/ip协议"></a>tcp/ip协议</h2><p>摘自：<a target="_blank" rel="noopener" href="https://www.tiocloud.com/doc/tio/78">TCP/IP协议分层模型</a></p>
<p><img src="/2022/12/30/%E5%A6%82%E4%BD%95%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0netty/tcp01.png" alt="tcp01"></p>
<h3 id="应用层是啥？"><a href="#应用层是啥？" class="headerlink" title="应用层是啥？"></a>应用层是啥？</h3><p>你想用java写一个网络程序，你写的这个程序就是应用层<br>所以QQ、微信、以及你正在使用的浏览器，都是应用层</p>
<h3 id="应用层数据是啥？"><a href="#应用层数据是啥？" class="headerlink" title="应用层数据是啥？"></a>应用层数据是啥？</h3><p>你想通过你前面写的这个网络程序发一个字符串”are you ok”到对方，这个字符串”are you ok”就是应用层数据<br>对方回你一句”yes, I am fine”，这个”yes, I am fine”也是应用层数据</p>
<h3 id="传输层是啥"><a href="#传输层是啥" class="headerlink" title="传输层是啥"></a>传输层是啥</h3><p>传输层要么走TCP协议，要么走UDP协议，没有第三种协议<br>TCP协议的通信双方，需要知道彼此都在家呆着，且由客户端主动发起连接<br>UDP协议，客户端知道服务器家住在哪，但并不知道服务器在不在家，扔条消息去服务器家，如果服务器不在家这条消息就被丢了<br>应用层把数据丢给传输层后，传输层把数据进行一下包装，包装纸上面写着“源端口、目的端口、序号、确认序号、检验和等TCP自身的数据”<br>传输层把数据给应用层时，会拆开对方的包装纸，应用层只看得到对方应用层发的数据</p>
<h3 id="传输层数据是啥"><a href="#传输层数据是啥" class="headerlink" title="传输层数据是啥"></a>传输层数据是啥</h3><p>就是应用层的数据带上一张包装纸后的数据<br>这层包装纸就是传输层的元数据或叫头部数据<br>为什么要带包装纸？因为要实名呀，现在快递都要实名了^_^</p>
<h1 id="1-Netty架构"><a href="#1-Netty架构" class="headerlink" title="1 Netty架构"></a>1 Netty架构</h1><h1 id="2-基本概念"><a href="#2-基本概念" class="headerlink" title="2 基本概念"></a>2 基本概念</h1><h2 id="Buffer-ByteBuffer"><a href="#Buffer-ByteBuffer" class="headerlink" title="Buffer: ByteBuffer"></a>Buffer: ByteBuffer</h2><h1 id="3-实战项目"><a href="#3-实战项目" class="headerlink" title="3 实战项目"></a>3 实战项目</h1><h2 id="3-1-IM聊天类"><a href="#3-1-IM聊天类" class="headerlink" title="3.1 IM聊天类"></a>3.1 IM聊天类</h2><p>Netty 入门与实战：仿写微信 IM 即时通讯系统<br>来自lightningMan大佬的：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/lightningMan">https://github.com/lightningMan</a></p>
<p>Netty 入门与实战：仿写微信 IM 即时通讯系统</p>
<p>使用Netty实现了单聊和群聊，将Netty从基础到项目一体化，可以说是入门Netty不错的选择。</p>
<h2 id="3-2-RPC类"><a href="#3-2-RPC类" class="headerlink" title="3.2 RPC类"></a>3.2 RPC类</h2><h3 id="SOFABolt"><a href="#SOFABolt" class="headerlink" title="SOFABolt"></a>SOFABolt</h3><p>蚂蚁金融服务集团开发的一套基于 Netty 实现的网络通信框架。</p>
<p>地址：<a target="_blank" rel="noopener" href="https://github.com/sofastack/sofa-bolt">https://github.com/sofastack/sofa-bolt</a></p>
<p>SOFABolt 是蚂蚁金融服务集团开发的一套基于 Netty 实现的网络通信框架。</p>
<p>为了让 Java 程序员能将更多的精力放在基于网络通信的业务逻辑实现上，而不是过多的纠结于网络底层 NIO 的实现以及处理难以调试的网络问题，Netty 应运而生。<br>为了让中间件开发者能将更多的精力放在产品功能特性实现上，而不是重复地一遍遍制造通信框架的轮子，SOFABolt 应运而生。<br>目前该产品已经运用在了蚂蚁中间件的微服务 (SOFARPC)、消息中心、分布式事务、分布式开关、以及配置中心等众多产品上。</p>
<h3 id="大厨小鲜——基于Netty自己动手实现RPC框架"><a href="#大厨小鲜——基于Netty自己动手实现RPC框架" class="headerlink" title="大厨小鲜——基于Netty自己动手实现RPC框架"></a>大厨小鲜——基于Netty自己动手实现RPC框架</h3><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/35720383">大厨小鲜——基于Netty自己动手实现RPC框架</a></p>
<h2 id="3-3-MQTT类"><a href="#3-3-MQTT类" class="headerlink" title="3.3 MQTT类"></a>3.3 MQTT类</h2><p>陆陆大神的：<a target="_blank" rel="noopener" href="https://github.com/1ssqq1lxr/iot_push">https://github.com/1ssqq1lxr/iot_push</a></p>
<p>MQTT 协议是 IBM 开发的即时通讯协议，相对于 IM 的实际上的准标准协议 XMPP 来说，MQTT 更小，更快，更轻量。MQTT 适合于任何计算能力有限，工作在低带宽、不可靠的网络中的设备，包括手机，传感器等等。</p>
<h2 id="3-4-Web框架"><a href="#3-4-Web框架" class="headerlink" title="3.4 Web框架"></a>3.4 Web框架</h2><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/36064672">大厨小鲜——基于Netty自己动手实现Web框架</a></p>
<h1 id="4-理解Netty"><a href="#4-理解Netty" class="headerlink" title="4 理解Netty"></a>4 理解Netty</h1><p>转自：<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/24322387/answer/2302486578">https://www.zhihu.com/question/24322387/answer/2302486578</a></p>
<p>这玩意其实用的地方非常普遍，可以说，一般基于 Java 的中间件，凡是需要用到底层通信能力， 都会基于 Netty 来构建。毕竟已经有了优秀的轮子何必自己再造一个可能都是bug的轮子呢？</p>
<p>所以 Netty 是一个底层通信框架，那何为底层通信框架？不就是通信嘛， 主要功能就是让服务端和客户端之间得以“交流”。</p>
<p>在有一定的基础下，我们可以闭上眼睛思考这样的框架应该需要哪些核心要点。 拿 Netty 举例，可以假设老板给我个任务，要我写一个底层通信框架，我要怎么写？ 都有哪些方面需要考虑？<br>通过这种驱动式自我提问，来推动自己不得不去思考， 被动让脑子转！这样会让你理解地更深刻。下面我们一起来思考下这个问题。</p>
<h2 id="写一个底层通信框架需要考虑哪些？"><a href="#写一个底层通信框架需要考虑哪些？" class="headerlink" title="写一个底层通信框架需要考虑哪些？"></a>写一个底层通信框架需要考虑哪些？</h2><p>关于通信，我第一个想到的就是网络协议，<br>好在一些协议底层都已经帮我们实现，但是要通信还是避免不了和底层打交道。<br>比如，要调用操作系统的接口来发送数据给远程，如果要我们去实现还得去了解操作系统的各种接口，感觉有点麻烦。<br>但好在，这样底层的交互，身为一门语言肯定是已经提供了封装的，对于 Java 而言提供了 NIO。</p>
<p>所以，通信的一些基本操作，包括创建 socket、建立连接、发送消息、接收消息等等，这些 NIO 都提供了。这样岂不是直接用 Java NIO 就行了？<br>用肯定是要用的，但是这种语言类库提供的接口，需要给予上层更多自由的配置，也就是它能提供精细化地调用，但是对于通常的使用而言过于复杂。<br>就好下面这张图，对于已经深耕的专业人员来说，可能极好。</p>
<p><img src="/2022/12/30/%E5%A6%82%E4%BD%95%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0netty/netty02.png" alt="netty02"></p>
<p>但是对于普通使用者而言，上手成本就太高了。</p>
<p>简而言之，就是封装的不够完美，不够简单。我们追求的是仪表盘只需暴露几个键，只要按几个键应用即可成功的运行，</p>
<p>所以我们需要基于 Java NIO 做封装，把一些复杂的配置隐藏起来，对外暴露出更加易用的接口。</p>
<p>所以，我们的第一个目标已经明确了，利用  Java NIO 提供的能力并基于它做封装，尽量简化配置，易于使用。(其实框架都这样，例如 Mybatis 之类的，还是得基于 JDBC 的能力，在此之上封装)<br>大体目标有了，然后得丰富一下功能性。由于网络通信都是字节流，所以我们还要提供编解码的支持，且需要支持各种协议，毕竟身为一个框架需要供各种团队使用，每个团队涉及的通信协议可能有所不同，<br>因此框架需要尽可能的支持市面上常见的应用层协议，比如 HTTP、DNS 等等，当然也要方便的定制自定义协议。</p>
<p>对了，还需要考虑粘包和拆包等问题，支持分隔符切分、固定长度等等，给予“客户”更多方便的选择！<br>实现上面这些，一些基本的通信需求满足了，<br>然后再考虑性能。身为一个网络通信框架，我们需要考虑连接的管理，毕竟资源是有限的，所以合理的连接数很重要，<br>因此我们需要提供心跳、检查空闲连接等功能来管理连接。</p>
<p>还有 I/O 模型，现在这个“行情”不说了，直接多路复用，用更少的线程处理更多的请求， hold 住海量连接。<br>等啥时候 Linux 完美支持 AIO 了再上个 AIO，不过 Linux 提供了 epoll ，<br>所以如果服务是跑在 Linux 上的就用 epoll，反之用 select。<br>对了，网上经常还会提到<strong>零拷贝</strong>，这个肯定是要的，比如发送一些文件的时候直接利用零拷贝减少拷贝次数，<br>并且还能用 DirectBuffer 将数据放置堆外，省去了堆内外的一次拷贝，提升性能。</p>
<p>当然对应的还得需要做好内存管理，这个我想可以参考参考 Linux 的伙伴系统。<br>关于线程模型，也得研究研究，例如 accept 线程与 reactor 线程(I/O线程)与业务处理线程的编排等等，在大流量下合理的线程模型会减少线程切换次数，提高性能，这很关键。</p>
<p>然后一个框架想要易用，不仅要适配不同团队的不同需求，还需方便适配同一团队的需求变更。这就需要框架必须要提供十分方便的定制化、插件化功能，这又该怎么设计？</p>
<p>责任链模式就适合这个，配合事件驱动，好像挺完美的。我个人认为，身为一个框架，提供诸多开箱即用的功能、接口易用、性能好、易扩展，那简直就是完美！</p>
<p>总之，通信框架的思考可以从功能出发：配置启动服务、建立连接、接收数据、处理业务、发送数据、关闭连接、关闭服务。从这条主线入手，<br>分别考虑上述说的，易用的接口、I/O 模型、编解码、开箱即用的协议支持、线程模型、连接管理、内存管理等。<br>综上，这就是我个人认为实现一个底层通信框架要思考的一些核心点，当然还有很多细节和一些锦上添花的功能，这还得再细细的盘一盘。<br>可以看到，要做一款通信框架，并没有那么简单，有很多需要考虑，这也是为什么那么多中间件底层通信框架不自己实现，而是都利用 Netty 的原因。<br>因为 Netty 将这些都实现了。</p>
<h2 id="什么是Netty？"><a href="#什么是Netty？" class="headerlink" title="什么是Netty？"></a>什么是Netty？</h2><p>它是高性能 Java 网络通信的底层框架，可能你听过的很多中间件底层通信框架用的都是它，例如 RocketMQ、Dubbo、Elasticsearch、Cassandra等。 </p>
<p>它为什么这么流行？为什么这么多中间件都在它之上构建？</p>
<h3 id="易用"><a href="#易用" class="headerlink" title="易用"></a>易用</h3><p>对 Java 的 NIO 进行了封装，屏蔽了 NIO 使用的复杂性，简化了网络通信的开发。且支持众多协议，不仅仅 HTTP、HTTP2、DNS、Redis 协议等等。</p>
<p>网络编程需要考虑粘包和拆包问题，连接的管理，编解码的处理，Netty都为你定制好了，开箱即用。还提供的内存泄漏检测，IP过滤、流量整型等高级功能。</p>
<h3 id="性能"><a href="#性能" class="headerlink" title="性能"></a>性能</h3><p>良好的I/O模型。</p>
<p>Netty 基于 Java NIO 封装实现了 I/O 多路复用，可由一个线程轮询多个底层 channel，减少了线程资源，也减少了多线程切换带来的开销，能更好的处理海量连接，提升系统的性能。</p>
<p>在 Linux 环境下也会用更优的 epoll 模型。运用零拷贝技术。不仅利用操作系统提供的零拷贝，也基于堆外内存省了一次 JVM 堆内外之间的拷贝。对象池技术，通过对象的复用，避免频繁创建和销毁带来的开销。</p>
<h3 id="扩展性"><a href="#扩展性" class="headerlink" title="扩展性"></a>扩展性</h3><p>基于事件驱动模型，将业务实现剥离成一个个 ChannelHandler ，利用责任链模式，可以很好的根据不同业务进行扩展，使用者只需要实现相关的 ChannelHandler 即可，框架与业务隔离。</p>
<p>可以根据情况配置线程模型，例如主从 Reactor ，主多从 Reactor 等等。</p>
<h3 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h3><p>这篇，只是从一个很高的纬度来谈谈一个底层网络通信框架的实现需要包含哪些核心点，以及 Netty 的一个很粗的概况，如果你 Netty 有深入的兴趣，可以看我这一系列的文章，已经写了 7 篇了。</p>
<p>链接：<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzkxNTE3NjQ3MA==&action=getalbum&album_id=2126839054972354563&scene=126#wechat_redirect">干翻Netty</a></p>

      
       <hr><span style="font-style: italic;color: gray;"> 竭尽全力、专心致志、全神贯注的做好分内之事。 </span>
    </div>
</article>


<p>
    <a  class="dashang" onclick="dashangToggle()">💰</a>
</p>






    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    ©2016-2023 净霆
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="切换全屏 快捷键 s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

<div class="hide_box" onclick="dashangToggle()"></div>
<div class="shang_box">
    <a class="shang_close"  onclick="dashangToggle()">×</a>
    <div class="shang_tit">
        <p>Help us with donation</p>
    </div>
    <div class="shang_payimg">
        <div class="pay_img">
            <img src="/img/alipay.jpg" class="alipay" title="扫码支持">
            <img src="/img/weixin.jpg" class="weixin" title="扫码支持">
        </div>
    </div>
    <div class="shang_payselect">
        <span><label><input type="radio" name="pay" checked value="alipay">alipay</label></span><span><label><input type="radio" name="pay" value="weixin">weixin</label></span>
    </div>
</div>


</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        
        $("input[name=pay]").on("click", function () {
            if($("input[name=pay]:checked").val()=="weixin"){
                $(".shang_box .shang_payimg .pay_img").addClass("weixin_img");
            } else {
                $(".shang_box .shang_payimg .pay_img").removeClass("weixin_img");
            }
        })
        

        /*高亮代码块行号*/
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    
    function dashangToggle() {
        $(".shang_box").fadeToggle();
        $(".hide_box").fadeToggle();
    }
    

</script>

<!--加入行号的高亮代码块样式-->

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    

    
</style>







</html>
